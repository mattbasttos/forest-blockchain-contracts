# üß™ Testes de Desempenho - Blockchain de Cr√©ditos de Carbono REDD+

Este reposit√≥rio cont√©m os scripts de teste de carga e desempenho desenvolvidos com **Locust** e **Web3.py** para validar a arquitetura distribu√≠da de cr√©ditos de carbono. Os testes avaliam a lat√™ncia, vaz√£o (*throughput*) e integridade dos contratos inteligentes na rede permissionada (Hyperledger Besu/Anvil).

## üìã Pr√©-requisitos

Antes de executar os testes, certifique-se de ter o ambiente configurado:

* **Python 3.8+**

### Instala√ß√£o das Depend√™ncias

Instale as bibliotecas Python necess√°rias:

```bash
pip install locust web3 hexbytes

```

---

## ‚öôÔ∏è Configura√ß√£o do Ambiente

1. **Inicie a Blockchain Local:**

2. **Deploy dos Contratos:**
Fa√ßa o deploy dos contratos `forestMonitor` e `carbonRetirement`.
* *Nota: O `carbonRetirement` deve receber o endere√ßo do `forestMonitor` no construtor.*


3. **Atualize os Scripts:**
Abra os arquivos `.py` e atualize as constantes com os endere√ßos gerados na etapa anterior:
```python
FOREST_ADDRESS = "0x..." 
CARBON_ADDRESS = "0x..."

```


*Certifique-se tamb√©m de que os arquivos `.json` com o ABI dos contratos est√£o na mesma pasta (ou no caminho correto).*

---

## üöÄ Executando os Testes

Para facilitar a an√°lise, os testes foram segregados em dois arquivos distintos.

### 1. Teste do Monitoramento (`teste-foresfMonitor.py`)

Foca no registro de dados geoespaciais e cria√ß√£o dos NFTs.

* **Objetivo:** Medir o custo de persist√™ncia de metadados complexos *on-chain*.
* **Cen√°rio:** Escrita (`createforestRecord`) vs Leitura (`getforestRecord`).

**Comando para rodar com Interface Web:**

```bash
locust -f teste-foresfMonitor.py

```

Acesse `http://localhost:8089` e configure a quantidade de usu√°rios.

### 2. Teste de Aposentadoria (`teste-carbonRetirement.py`)

Foca no ciclo de vida do cr√©dito e preven√ß√£o de dupla contagem.

* **Objetivo:** Validar a atomicidade da fun√ß√£o `retireCredit`.
* **L√≥gica:** O script realiza um *Mint* invis√≠vel (n√£o contabilizado no tempo) antes de medir exclusivamente o tempo da transa√ß√£o de *Retire*.
* **Cen√°rio:** Escrita (`retireCredit`) vs Leitura (`isRetired`).

**Comando de execu√ß√£o:**

```bash
locust -f teste-carbonRetirement.py

```

## üìä Interpretando os Resultados

O Locust gerar√° estat√≠sticas no terminal ou na interface web. Para o artigo, foque nas seguintes m√©tricas:

1. **RPS (Requests Per Second):** O *Throughput* da rede. Deve crescer linearmente com o n√∫mero de usu√°rios at√© o ponto de satura√ß√£o.
2. **Average Latency (ms):**
* **Leitura:** Esperado < 20ms (Processamento local).
* **Escrita:** Esperado > 100ms (Custo do Consenso/Minera√ß√£o).


3. **Failures:** Devem ser **0**. Qualquer falha indica erro de *nonce*, falta de *gas* ou erro na l√≥gica do contrato (ex: dupla contagem bloqueada corretamente gera erro no Locust se n√£o tratada, mas no nosso script capturamos isso como sucesso da l√≥gica de neg√≥cio se for a inten√ß√£o).

## üõ†Ô∏è Resolu√ß√£o de Problemas Comuns

* **Erro `Nonce too low`:**
* Isso acontece se o Locust enviar transa√ß√µes mais r√°pido do que o n√≥ consegue confirmar.
* *Solu√ß√£o:* Reinicie o Anvil para resetar os nonces ou aumente o `wait_time` na classe `User` do script.


* **Erro `File not found (ABI)`:**
* Verifique se o caminho para `forestMonitor.json` ou `CarbonRetirement.json` est√° correto no in√≠cio do script.


* **Lat√™ncia de Escrita Zerada ou Falha Instant√¢nea:**
* Geralmente indica que a transa√ß√£o nem chegou a ser enviada (erro de assinatura ou endere√ßo errado). Verifique as chaves privadas e endere√ßos dos contratos.